<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced English Assessment</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            flex: 1;
        }

        .loader {
            border: 16px solid #f3f3f3;
            border-top: 16px solid #3498db;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: spin 2s linear infinite;
            position: absolute;
            left: 50%;
            top: 50%;
            margin-left: -60px;
            margin-top: -60px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loader-container {
            position: relative;
            height: 100px;
            text-align: center;
            margin-top: 20px;
        }

        #analysisSection {
            display: none;
        }

        .timer {
            text-align: center;
            margin-top: 20px;
        }

        .timer-display {
            font-size: 2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .btn-custom {
            margin: 0 5px;
            font-size: 1rem;
        }

        footer {
            background-color: #343a40;
            color: #fff;
            padding: 10px;
            text-align: center;
            position: sticky;
            bottom: 0;
            width: 100%;
        }

        .emoji {
            font-size: 1.5rem;
        }
    </style>
</head>
<body>

<div class="container mt-5">
    <h2 class="text-center mb-4">üìù Advanced English Assessment for SEBI, NABARD, & RBI</h2>

    <div class="timer">
        <div class="timer-display" id="timerDisplay">00:00:00</div>
        <button id="startTimer" class="btn btn-success btn-custom">Start <i class="fas fa-play"></i></button>
        <button id="stopTimer" class="btn btn-warning btn-custom">Stop <i class="fas fa-pause"></i></button>
        <button id="resetTimer" class="btn btn-danger btn-custom">Reset <i class="fas fa-stop"></i></button>
    </div>

    <form id="essayForm">
        <div class="form-group">
            <label for="titleInput">üóíÔ∏è Essay Title:</label>
            <input type="text" class="form-control" id="titleInput" name="titleInput" required placeholder="Enter the title of your essay">
        </div>
        <div class="form-group">
            <label for="essayInput">üñãÔ∏è Enter your essay below:</label>
            <textarea class="form-control" id="essayInput" name="essayInput" rows="10" placeholder="Type your essay here..." required></textarea>
        </div>
        <div class="form-group">
            <button type="submit" class="btn btn-primary btn-custom">Analyze Essay <i class="fas fa-check"></i></button>
        </div>
    </form>

    <div class="form-group">
        <h5>üìñ Live Word Count: <span id="liveWordCount">0</span></h5>
    </div>

    <div id="alertContainer" class="mb-3"></div>

    <div id="analysisSection" class="mt-4">
        <h4>üîç Essay Analysis</h4>
        <div id="analysisText"></div>
    </div>

    <div class="loader-container" id="loaderContainer" style="display: none;">
        <div class="loader"></div>
    </div>
</div>

<footer>
    <p>&copy; 2024 Advanced English Assessment for SEBI, NABARD, & RBI. All rights reserved. üöÄ</p>
</footer>

<!-- Bootstrap JS and dependencies -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>

<script>
$(document).ready(function() {
    var timerInterval;
    var timerSeconds = 0;

    function updateTimer() {
        var hours = Math.floor(timerSeconds / 3600);
        var minutes = Math.floor((timerSeconds % 3600) / 60);
        var seconds = timerSeconds % 60;
        $('#timerDisplay').text(
            (hours < 10 ? '0' : '') + hours + ':' +
            (minutes < 10 ? '0' : '') + minutes + ':' +
            (seconds < 10 ? '0' : '') + seconds
        );
    }

    $('#startTimer').click(function() {
        timerInterval = setInterval(function() {
            timerSeconds++;
            updateTimer();
        }, 1000);
    });

    $('#stopTimer').click(function() {
        clearInterval(timerInterval);
    });

    $('#resetTimer').click(function() {
        clearInterval(timerInterval);
        timerSeconds = 0;
        updateTimer();
    });

    $('#essayInput').on('input', function() {
        var text = $(this).val();
        var wordCount = text ? text.split(/\s+/).length : 0;
        $('#liveWordCount').text(wordCount);
    });

    $('#essayForm').on('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission

        var title = $('#titleInput').val().trim();
        var essay = $('#essayInput').val().trim();

        if (!title || !essay) {
            $('#alertContainer').html('<div class="alert alert-danger" role="alert">Please fill out the title and essay fields before submitting. üõë</div>');
            return;
        }

        var formData = $(this).serialize();
        $('#loaderContainer').show(); // Show the spinner

        $.ajax({
            url: 'process.php',
            type: 'POST',
            data: formData,
            dataType: 'json',
            success: function(response) {
                $('#loaderContainer').hide(); // Hide the spinner
                $('#wordCount').text(response.wordCount);

                if (response.alert) {
                    $('#alertContainer').html('<div class="alert alert-' + response.alert.type + '" role="alert">' + response.alert.message + '</div>');
                }

                if (response.analysis) {
                    $('#analysisSection').show();
                    $('#analysisText').html(response.analysis);
                } else if (response.alert && response.alert.type === 'danger') {
                    $('#analysisSection').hide();
                }
            },
            error: function() {
                $('#loaderContainer').hide(); // Hide the spinner
                $('#alertContainer').html('<div class="alert alert-danger" role="alert">An error occurred while processing your request. Please try again. ‚ö†Ô∏è</div>');
            }
        });
    });
});
</script>

</body>
</html>
